# iTabs Browser Extension Technical Specification

## Overview

The iTabs Browser Extension will enable rich, interactive previews of websites that implement iTabs metadata. This extension will detect when a user hovers over links, fetch and parse the metadata from the destination page, and display a tabbed preview interface without requiring the user to leave their current page.

## Core Functionality

1. **Link Hover Detection**: Monitor mouse hover events on hyperlinks (`<a>` tags)
2. **Metadata Fetching**: Request and parse iTabs metadata from target URLs
3. **Preview Rendering**: Generate and display tabbed preview cards
4. **User Interaction**: Handle tab switching and preview navigation
5. **Performance Optimization**: Implement caching and prefetching strategies

## Technical Architecture

### Browser Support

- Initial release: Chrome/Edge (Chromium-based browsers)
- Future expansion: Firefox, Safari

### Components

#### 1. Background Script (`background.js`)

- Maintains extension state and configuration
- Handles caching of fetched metadata
- Manages content script injection

```javascript
// Background script pseudo-code
chrome.runtime.onInstalled.addListener(() => {
  // Initialize cache
  chrome.storage.local.set({ metadata_cache: {} });
  
  // Set default configuration
  chrome.storage.local.set({
    config: {
      enabled: true,
      hoverDelay: 300, // ms
      cacheDuration: 86400000, // 24 hours in ms
      prefetchEnabled: true
    }
  });
});

// Handle metadata requests from content script
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  if (request.action === "fetchMetadata") {
    fetchAndCacheMetadata(request.url)
      .then(metadata => sendResponse({ success: true, metadata }))
      .catch(error => sendResponse({ success: false, error }));
    return true; // Keep channel open for async response
  }
});
```

#### 2. Content Script (`content.js`)

- Monitors link hover events
- Requests metadata from background script
- Renders preview UI

```javascript
// Content script pseudo-code
document.addEventListener('mouseover', event => {
  // Check if target is a link
  if (event.target.tagName === 'A' && event.target.href) {
    const url = event.target.href;
    
    // Start hover timer
    const hoverTimer = setTimeout(() => {
      // Request metadata
      chrome.runtime.sendMessage(
        { action: "fetchMetadata", url },
        response => {
          if (response.success && response.metadata.enabled) {
            renderPreview(event.target, response.metadata);
          }
        }
      );
    }, config.hoverDelay);
    
    // Clear timer on mouseout
    event.target.addEventListener('mouseout', () => {
      clearTimeout(hoverTimer);
      removePreview();
    }, { once: true });
  }
});
```

#### 3. Metadata Fetcher Module (`metadata-fetcher.js`)

- Requests page HTML
- Extracts iTabs metadata
- Formats and validates data

```javascript
// Metadata fetcher pseudo-code
async function fetchAndCacheMetadata(url) {
  // Check cache first
  const cache = await chrome.storage.local.get('metadata_cache');
  if (cache.metadata_cache[url] && 
      (Date.now() - cache.metadata_cache[url].timestamp < config.cacheDuration)) {
    return cache.metadata_cache[url].data;
  }
  
  // Fetch page HTML
  const response = await fetch(url);
  const html = await response.text();
  
  // Create DOM parser
  const parser = new DOMParser();
  const doc = parser.parseFromString(html, 'text/html');
  
  // Extract iTabs metadata
  const metadata = extractITabsMetadata(doc);
  
  // Update cache
  if (metadata.enabled) {
    cache.metadata_cache[url] = {
      data: metadata,
      timestamp: Date.now()
    };
    await chrome.storage.local.set({ metadata_cache: cache.metadata_cache });
  }
  
  return metadata;
}

function extractITabsMetadata(doc) {
  // Initialize metadata object
  const metadata = {
    enabled: false,
    title: '',
    description: '',
    image: '',
    tabs: {}
  };
  
  // Get all meta tags
  const metaTags = doc.querySelectorAll('meta[name^="itabs:"]');
  
  // Process each meta tag
  metaTags.forEach(tag => {
    const property = tag.getAttribute('name');
    const content = tag.getAttribute('content');
    
    // Process based on property name
    if (property === 'itabs:enabled' && content === 'true') {
      metadata.enabled = true;
    } else if (property === 'itabs:title') {
      metadata.title = content;
    } else if (property === 'itabs:description') {
      metadata.description = content;
    } else if (property === 'itabs:image') {
      metadata.image = content;
    } else if (property.startsWith('itabs:tab:')) {
      // Extract tab name (e.g., 'overview' from 'itabs:tab:overview')
      const tabName = property.replace('itabs:tab:', '');
      
      // Handle JSON content if applicable
      try {
        // Try to parse as JSON
        const jsonContent = JSON.parse(content);
        metadata.tabs[tabName] = jsonContent;
      } catch (e) {
        // Not JSON, use as plain text
        metadata.tabs[tabName] = content;
      }
    }
  });
  
  return metadata;
}
```

#### 4. Preview UI Renderer (`preview-ui.js`)

- Creates and positions preview card
- Builds tab interface
- Handles user interactions

```javascript
// Preview UI renderer pseudo-code
function renderPreview(target, metadata) {
  // Create preview container
  const preview = document.createElement('div');
  preview.className = 'itabs-preview';
  
  // Position relative to target link
  positionPreview(preview, target);
  
  // Create header with image and title
  preview.innerHTML = `
    <div class="itabs-header">
      ${metadata.image ? `<img src="${metadata.image}" alt="${metadata.title}">` : ''}
      <div class="itabs-title-container">
        <h3>${metadata.title}</h3>
        <p>${metadata.description}</p>
      </div>
    </div>
  `;
  
  // Create tab navigation
  const tabNav = document.createElement('div');
  tabNav.className = 'itabs-tabs';
  
  // Create tab content container
  const tabContent = document.createElement('div');
  tabContent.className = 'itabs-tab-content';
  
  // Add tabs
  let isFirst = true;
  Object.keys(metadata.tabs).forEach(tabName => {
    // Create tab button
    const tab = document.createElement('button');
    tab.className = `itabs-tab ${isFirst ? 'active' : ''}`;
    tab.textContent = tabName.charAt(0).toUpperCase() + tabName.slice(1);
    tab.dataset.tab = tabName;
    tabNav.appendChild(tab);
    
    // Create tab content
    const content = document.createElement('div');
    content.className = `itabs-content ${isFirst ? 'active' : ''}`;
    content.dataset.tab = tabName;
    
    // Handle different content types
    if (typeof metadata.tabs[tabName] === 'object') {
      content.innerHTML = formatObjectContent(metadata.tabs[tabName]);
    } else {
      content.textContent = metadata.tabs[tabName];
    }
    
    tabContent.appendChild(content);
    
    isFirst = false;
  });
  
  // Add tab navigation and content to preview
  preview.appendChild(tabNav);
  preview.appendChild(tabContent);
  
  // Add visit link button
  preview.innerHTML += `
    <div class="itabs-footer">
      <a href="${target.href}" class="itabs-visit-link">Visit Page</a>
    </div>
  `;
  
  // Add to page
  document.body.appendChild(preview);
  
  // Add event listeners for tab switching
  preview.querySelectorAll('.itabs-tab').forEach(tab => {
    tab.addEventListener('click', (e) => {
      const tabName = e.target.dataset.tab;
      
      // Deactivate all tabs
      preview.querySelectorAll('.itabs-tab, .itabs-content').forEach(el => {
        el.classList.remove('active');
      });
      
      // Activate selected tab
      preview.querySelector(`.itabs-tab[data-tab="${tabName}"]`).classList.add('active');
      preview.querySelector(`.itabs-content[data-tab="${tabName}"]`).classList.add('active');
    });
  });
}
```

#### 5. Popup UI (`popup.html`, `popup.js`)

- Toggle extension on/off
- Adjust configuration settings
- View statistics

#### 6. Options Page (`options.html`, `options.js`)

- Detailed configuration options
- Cache management
- Customization options

### User Interface Design

#### Preview Card UI

The preview card will include:

1. **Header Section**
   - Featured image (if available)
   - Title
   - Brief description

2. **Tab Navigation**
   - Horizontally arranged tabs
   - Active tab indicator
   - Automatic tab rotation option

3. **Content Area**
   - Tab-specific content
   - Support for text, lists, and tables
   - Properly formatted JSON data

4. **Footer**
   - Visit link button
   - Optional share functionality
   - Branding (iTabs powered)

```css
/* Core Preview Card Styling */
.itabs-preview {
  position: absolute;
  z-index: 10000;
  width: 350px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.2);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, sans-serif;
  overflow: hidden;
  animation: itabs-fade-in 0.2s ease-out;
}

.itabs-header {
  display: flex;
  padding: 12px;
  border-bottom: 1px solid #eee;
}

.itabs-header img {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 4px;
  margin-right: 12px;
}

.itabs-title-container h3 {
  margin: 0 0 5px 0;
  font-size: 16px;
  color: #333;
}

.itabs-title-container p {
  margin: 0;
  font-size: 14px;
  color: #666;
}

.itabs-tabs {
  display: flex;
  background: #f5f5f5;
  border-bottom: 1px solid #eee;
}

.itabs-tab {
  padding: 8px 12px;
  background: none;
  border: none;
  cursor: pointer;
  font-size: 14px;
  color: #666;
}

.itabs-tab.active {
  background: white;
  color: #1a73e8;
  border-bottom: 2px solid #1a73e8;
}

.itabs-tab-content {
  position: relative;
  min-height: 100px;
}

.itabs-content {
  display: none;
  padding: 12px;
  font-size: 14px;
  line-height: 1.4;
  color: #333;
}

.itabs-content.active {
  display: block;
}

.itabs-footer {
  padding: 12px;
  border-top: 1px solid #eee;
  text-align: right;
}

.itabs-visit-link {
  display: inline-block;
  padding: 8px 12px;
  background: #1a73e8;
  color: white;
  text-decoration: none;
  border-radius: 4px;
  font-size: 14px;
}

@keyframes itabs-fade-in {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}
```

## Technical Challenges & Solutions

### 1. Cross-Origin Requests

**Challenge**: Fetching metadata from external domains faces cross-origin restrictions.

**Solution**: Use the extension's background script which has broader permissions to make cross-origin requests.

### 2. Performance Impact

**Challenge**: Fetching metadata for every link hover could create performance issues.

**Solutions**:
- Implement hover delay to prevent unnecessary requests
- Cache fetched metadata locally
- Implement intelligent prefetching for links in the viewport
- Use throttling to limit concurrent requests

### 3. Positioning Logic

**Challenge**: Preview cards must be positioned to avoid going off-screen.

**Solution**: Implement smart positioning logic that detects viewport edges and adjusts accordingly.

```javascript
function positionPreview(preview, target) {
  const rect = target.getBoundingClientRect();
  const viewportWidth = window.innerWidth;
  const viewportHeight = window.innerHeight;
  const previewWidth = 350; // Preview card width
  
  // Check if there's enough space to the right
  if (rect.right + previewWidth + 20 <= viewportWidth) {
    // Position to the right
    preview.style.left = `${rect.right + 10}px`;
  } else if (rect.left - previewWidth - 20 >= 0) {
    // Position to the left
    preview.style.left = `${rect.left - previewWidth - 10}px`;
  } else {
    // Center horizontally if neither side has enough space
    preview.style.left = `${Math.max(10, Math.min(viewportWidth - previewWidth - 10, rect.left))}px`;
  }
  
  // Check vertical positioning
  if (rect.top + preview.offsetHeight + 20 <= viewportHeight) {
    // Position below
    preview.style.top = `${rect.bottom + 10}px`;
  } else {
    // Position above
    preview.style.top = `${Math.max(10, rect.top - preview.offsetHeight - 10)}px`;
  }
}
```

### 4. Content Security Policies

**Challenge**: Some websites have strict Content Security Policies that might block injection.

**Solution**: Create the preview UI as a shadow DOM element with self-contained styles to avoid CSP conflicts.

### 5. JSON Parsing

**Challenge**: Handling potentially malformed JSON content in metadata.

**Solution**: Implement robust parsing with proper error handling and fallbacks.

## Security Considerations

1. **Content Sanitization**: Sanitize all metadata content to prevent XSS attacks
2. **URL Validation**: Ensure URLs in metadata are properly validated and sanitized
3. **Resource Limitations**: Implement timeout limits for metadata fetching
4. **Permission Scope**: Limit permissions to only what's necessary
5. **User Control**: Allow users to disable the extension on specific sites

## Privacy Considerations

1. **Data Collection**: Minimize data collection to essential functionality
2. **Local Storage**: Keep metadata cache local to the user's browser
3. **Transparency**: Clearly communicate what data is collected and how it's used
4. **User Control**: Provide options to clear cached data

## Testing Strategy

1. **Unit Tests**: Core functionality components
2. **Integration Tests**: End-to-end preview generation
3. **Performance Tests**: Measure impact on page load and interaction
4. **Compatibility Tests**: Verify functionality across browsers and websites
5. **Security Audits**: Regular security reviews

## Development Roadmap

### Phase 1: Core Functionality (Weeks 1-2)
- Basic link hover detection
- Metadata fetching and parsing
- Simple preview card rendering

### Phase 2: UI Refinement (Weeks 3-4)
- Polished preview card design
- Tab switching animations
- Mobile-friendly interactions

### Phase 3: Optimization (Weeks 5-6)
- Caching system
- Performance improvements
- Intelligent prefetching

### Phase 4: Advanced Features (Weeks 7-8)
- Configuration options
- Statistics tracking
- Custom styling options

## Distribution Plan

1. **Chrome Web Store**: Primary distribution channel
2. **Developer Website**: Direct download for testing
3. **Firefox Add-ons**: Secondary browser support
4. **Documentation Site**: Implementation guides for websites

## Success Metrics

1. **Adoption Rate**: Number of active installations
2. **Engagement**: Frequency of preview interactions
3. **Website Implementation**: Number of sites with iTabs metadata
4. **User Feedback**: Ratings and reviews
5. **Performance Impact**: Minimal effect on browsing experience

## Appendix A: Sample Metadata Implementation

```html
<meta name="itabs:enabled" content="true">
<meta name="itabs:title" content="Sony WH-1000XM6 Wireless Headphones">
<meta name="itabs:description" content="Premium noise-cancelling headphones with 30-hour battery life.">
<meta name="itabs:image" content="https://example.com/sony-headphones.jpg">
<meta name="itabs:tab:overview" content="The Sony WH-1000XM6 continues Sony's legacy of exceptional noise-cancelling headphones.">
<meta name="itabs:tab:specs" content="{'noise_cancellation':'Adaptive with pressure sensors','battery':'30 hours','connectivity':'Bluetooth 5.3'}">
<meta name="itabs:tab:reviews" content="Exceptional sound quality with punchy bass and detailed highs.">
<meta name="itabs:tab:pricing" content="{'amazon':'379.99','bestbuy':'399.99','walmart':'389.99'}">
```

## Appendix B: Preview Card Design Mock

```
+----------------------------------+
|  [IMG]  | Sony WH-1000XM6        |
|         | Premium noise-cancell...|
+----------------------------------+
| Overview | Specs | Reviews | Price|
+----------------------------------+
| The Sony WH-1000XM6 continues    |
| Sony's legacy of exceptional     |
| noise-cancelling headphones with |
| improved drivers and enhanced    |
| noise cancellation technology.   |
|                                  |
+----------------------------------+
|                     [Visit Page] |
+----------------------------------+
```
<br>
<br>
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Basic SEO Meta Tags -->
<meta name="description" content="Transform ordinary links into information hubs with iTabs. Keep visitors on your page longer, boost conversions, and enhance user experience with this simple solution.">
<meta name="keywords" content="iTabs, link enhancement, website conversion, affiliate marketing, bounce rate reduction, user experience">
<meta name="author" content="iTabs.co">

<!-- Open Graph Meta Tags (Facebook, LinkedIn) -->
<meta property="og:title" content="iTabs - Keep Visitors on Your Page Longer">
<meta property="og:description" content="See how this tiny 'i' indicator transforms regular links into conversion machines. Try the interactive demo!">
<meta property="og:image" content=https://i.ibb.co/mmhC95q/IMG-2632.jpg>
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:url" content="https://your-demo-url.com">
<meta property="og:type" content="website">
<meta property="og:site_name" content="iTabs">

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="iTabs - Interactive Information Display">
<meta name="twitter:description" content="Transform your website with iTabs. 47% less exits, 32% higher conversions. Try our interactive demo!">
<meta name="twitter:image" content="https://path-to-your-image.jpg">
<meta name="twitter:url" content="https://your-demo-url.com">

<!-- Additional Meta Tags for Better Sharing -->
<meta property="og:locale" content="en_US">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://your-demo-url.com">

<!-- Pinterest Meta Tag -->
<meta name="pinterest-rich-pin" content="true"
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iTabs - Interactive Information Display</title>
    
    <!-- Open Graph tags for LinkedIn sharing -->
    <meta property="og:title" content="iTabs - Keep visitors on your page longer" />
    <meta property="og:description" content="See how this tiny 'i' indicator transforms regular links into conversion machines without sending visitors away." />
    <meta property="og:url" content="https://itabs-link-wizard.lovable.app/" />
    <meta property="og:type" content="website" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .demo-card {
            background: white;
            width: 100%;
            max-width: 500px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            overflow: hidden;
            position: relative;
        }
        
        .card-header {
            background: linear-gradient(135deg, #4066E0 0%, #5D7DF9 100%);
            padding: 25px;
            color: white;
        }
        
        .card-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .card-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .card-content {
            padding: 25px;
            position: relative;
        }
        
        .content-text {
            font-size: 16px;
            line-height: 1.6;
            color: #333;
            margin-bottom: 20px;
        }
        
        .highlight {
            font-weight: 500;
            color: #4066E0;
            display: inline-block;
            position: relative;
            cursor: pointer;
        }
        
        .i-indicator {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            background-color: #4066E0;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-style: italic;
            font-weight: bold;
            margin-left: 3px;
            position: relative;
            top: -8px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .i-indicator:hover {
            transform: scale(1.1);
        }
        
        .cta-button {
            display: inline-block;
            background: #4066E0;
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            margin-top: 10px;
            transition: background 0.2s ease;
        }
        
        .cta-button:hover {
            background: #3355CC;
        }
        
        .popup {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            z-index: 100;
            overflow: hidden;
            display: none;
            animation: fadeIn 0.3s ease forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -10px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }
        
        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .popup-title {
            font-weight: 600;
            color: #333;
        }
        
        .close-button {
            background: none;
            border: none;
            font-size: 20px;
            color: #999;
            cursor: pointer;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #eee;
        }
        
        .tab {
            flex: 1;
            padding: 12px 15px;
            text-align: center;
            background: #f8f8f8;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            transition: background 0.2s ease;
        }
        
        .tab:hover {
            background: #f0f0f0;
        }
        
        .tab.active {
            background: white;
            color: #4066E0;
            border-bottom: 2px solid #4066E0;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            line-height: 1.6;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .highlight-box {
            background: #f8faff;
            border-left: 4px solid #4066E0;
            padding: 15px;
            margin: 15px 0;
        }
        
        .feature-list {
            list-style-type: none;
            margin: 15px 0;
        }
        
        .feature-list li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
        }
        
        .feature-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #4066E0;
            font-weight: bold;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            text-align: center;
        }
        
        .stat-item {
            flex: 1;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: 600;
            color: #4066E0;
            display: block;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 99;
        }
        
        .popup-cta {
            display: block;
            background: #4066E0;
            color: white;
            text-align: center;
            padding: 15px;
            text-decoration: none;
            font-weight: 500;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="demo-card">
        <div class="card-header">
            <h1 class="card-title">Keep Visitors on Your Page Longer</h1>
            <p class="card-subtitle">See how iTabs enhances web content</p>
        </div>
        
        <div class="card-content">
            <p class="content-text">
                Did you know that <span class="highlight">47% of visitors<span class="i-indicator" id="statsIndicator">i</span></span> leave websites to research before making a purchase decision? 
                
                With <span class="highlight">iTabs<span class="i-indicator" id="whatIsIndicator">i</span></span> you can provide rich, contextual information without visitors leaving your page.
            </p>
            
            <p class="content-text">
                Discover how <span class="highlight">implementing iTabs<span class="i-indicator" id="howItWorksIndicator">i</span></span> is helping content creators and <span class="highlight">affiliate marketers<span class="i-indicator" id="gettingStartedIndicator">i</span></span> increase conversions by keeping visitors engaged.
            </p>
            
            <a href="https://itabs-link-wizard.lovable.app/" class="cta-button">Create Your Own iTabs</a>
        </div>
    </div>
    
    <div class="overlay" id="overlay"></div>
    
    <!-- What is iTabs Popup -->
    <div class="popup" id="whatIsPopup">
        <div class="popup-header">
            <div class="popup-title">What is iTabs?</div>
            <button class="close-button">&times;</button>
        </div>
        
        <div class="tab-content active">
            <p>iTabs transforms ordinary hyperlinks into information hubs that keep visitors on your page. By adding a small 'i' indicator to important terms or links, you provide instant access to rich, contextual information without forcing navigation away from your content.</p>
            
            <div class="highlight-box">
                Perfect for bloggers, affiliate marketers, and content creators who want to reduce bounce rates and increase engagement.
            </div>
            
            <p>iTabs works anywhere you have hyperlinks - no coding knowledge required.</p>
        </div>
        
        <a href="https://itabs-link-wizard.lovable.app/" class="popup-cta">Learn More About iTabs</a>
    </div>
    
    <!-- Stats Popup -->
    <div class="popup" id="statsPopup">
        <div class="popup-header">
            <div class="popup-title">Benefits & Impact</div>
            <button class="close-button">&times;</button>
        </div>
        
        <div class="tab-content active">
            <p>Websites using iTabs see dramatic improvements in key metrics:</p>
            
            <div class="stats-container">
                <div class="stat-item">
                    <span class="stat-number">47%</span>
                    <span class="stat-label">Less Research Exits</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">32%</span>
                    <span class="stat-label">Higher Conversions</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">3.8x</span>
                    <span class="stat-label">Longer Time on Page</span>
                </div>
            </div>
            
            <div class="highlight-box">
                The problem is simple: when visitors leave to research, they often don't return. iTabs keeps them engaged within your content ecosystem, dramatically improving your conversion opportunities.
            </div>
            
            <p>By providing immediate access to information, you reduce friction in the user journey and create a more satisfying experience for your visitors.</p>
        </div>
        
        <a href="https://itabs-link-wizard.lovable.app/" class="popup-cta">Boost Your Metrics</a>
    </div>
    
    <!-- How It Works Popup with Tabs -->
    <div class="popup" id="howItWorksPopup">
        <div class="popup-header">
            <div class="popup-title">Implementing iTabs</div>
            <button class="close-button">&times;</button>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="process">Process</div>
            <div class="tab" data-tab="technical">Technical</div>
            <div class="tab" data-tab="platforms">Platforms</div>
        </div>
        
        <div class="tab-content active" id="process">
            <p>Implementing iTabs is simple:</p>
            
            <ul class="feature-list">
                <li>Create your iTabs using our wizard</li>
                <li>Add one line of code to your website</li>
                <li>Customize which links have iTabs</li>
                <li>Watch your engagement improve</li>
            </ul>
            
            <div class="highlight-box">
                The entire setup process takes less than 10 minutes for most websites.
            </div>
        </div>
        
        <div class="tab-content" id="technical">
            <p>iTabs is lightweight and efficient:</p>
            
            <ul class="feature-list">
                <li>Minimal impact on page load speed</li>
                <li>Fully responsive on all devices</li>
                <li>Works with existing website code</li>
                <li>No dependencies required</li>
            </ul>
            
            <div class="highlight-box">
                Our script is only 12kb in size and loads asynchronously to ensure optimal performance.
            </div>
        </div>
        
        <div class="tab-content" id="platforms">
            <p>iTabs works everywhere:</p>
            
            <ul class="feature-list">
                <li>WordPress (plugin available)</li>
                <li>Shopify stores</li>
                <li>Custom websites</li>
                <li>Landing pages</li>
                <li>Email newsletters</li>
            </ul>
            
            <div class="highlight-box">
                If your platform can add a script tag or embed HTML, you can use iTabs.
            </div>
        </div>
        
        <a href="https://itabs-link-wizard.lovable.app/" class="popup-cta">See How Easy It Is</a>
    </div>
    
    <!-- Getting Started Popup with Tabs -->
    <div class="popup" id="gettingStartedPopup">
        <div class="popup-header">
            <div class="popup-title">Affiliate Marketing Success</div>
            <button class="close-button">&times;</button>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="challenge">Challenge</div>
            <div class="tab" data-tab="solution">Solution</div>
            <div class="tab" data-tab="results">Results</div>
        </div>
        
        <div class="tab-content active" id="challenge">
            <p>Affiliate marketers face unique challenges:</p>
            
            <ul class="feature-list">
                <li>Visitors leave to research products</li>
                <li>Each click away reduces commission chances</li>
                <li>Detailed product information clutters content</li>
                <li>Building trust requires additional context</li>
            </ul>
            
            <div class="highlight-box">
                These challenges directly impact the bottom line, with many affiliates losing 30-50% of potential commissions due to visitors leaving during research.
            </div>
        </div>
        
        <div class="tab-content" id="solution">
            <p>iTabs provides affiliate marketers with:</p>
            
            <ul class="feature-list">
                <li>Rich product information without leaving the page</li>
                <li>Organized details in easy-to-navigate tabs</li>
                <li>Seamless integration with existing affiliate links</li>
                <li>Mobile-friendly design that works everywhere</li>
            </ul>
            
            <div class="highlight-box">
                Implementation takes just minutes with no coding required. Simply create your iTabs and add one line of code to your website.
            </div>
        </div>
        
        <div class="tab-content" id="results">
            <div class="stats-container">
                <div class="stat-item">
                    <span class="stat-number">+32%</span>
                    <span class="stat-label">Conversion Rate</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">-41%</span>
                    <span class="stat-label">Bounce Rate</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">+27%</span>
                    <span class="stat-label">Commissions</span>
                </div>
            </div>
            
            <p>Affiliate marketers using iTabs report significant improvements in key metrics, directly impacting their bottom line.</p>
            
            <p>A typical affiliate with 10,000 monthly visitors can generate thousands in additional revenue by implementing iTabs.</p>
        </div>
        
        <a href="https://itabs-link-wizard.lovable.app/" class="popup-cta">Boost Your Affiliate Income</a>
    </div>

    <script>
        // Get elements
        const overlay = document.getElementById('overlay');
        const statsIndicator = document.getElementById('statsIndicator');
        const whatIsIndicator = document.getElementById('whatIsIndicator');
        const howItWorksIndicator = document.getElementById('howItWorksIndicator');
        const gettingStartedIndicator = document.getElementById('gettingStartedIndicator');
        
        const statsPopup = document.getElementById('statsPopup');
        const whatIsPopup = document.getElementById('whatIsPopup');
        const howItWorksPopup = document.getElementById('howItWorksPopup');
        const gettingStartedPopup = document.getElementById('gettingStartedPopup');
        
        const closeButtons = document.querySelectorAll('.close-button');
        const tabs = document.querySelectorAll('.tab');
        
        // Show stats popup
        statsIndicator.addEventListener('click', function(e) {
            e.stopPropagation();
            hideAllPopups();
            statsPopup.style.display = 'block';
            overlay.style.display = 'block';
        });
        
        // Show what is popup
        whatIsIndicator.addEventListener('click', function(e) {
            e.stopPropagation();
            hideAllPopups();
            whatIsPopup.style.display = 'block';
            overlay.style.display = 'block';
        });
        
        // Show how it works popup
        howItWorksIndicator.addEventListener('click', function(e) {
            e.stopPropagation();
            hideAllPopups();
            howItWorksPopup.style.display = 'block';
            overlay.style.display = 'block';
        });
        
        // Show getting started popup
        gettingStartedIndicator.addEventListener('click', function(e) {
            e.stopPropagation();
            hideAllPopups();
            gettingStartedPopup.style.display = 'block';
            overlay.style.display = 'block';
        });
        
        // Hide all popups
        function hideAllPopups() {
            statsPopup.style.display = 'none';
            whatIsPopup.style.display = 'none';
            howItWorksPopup.style.display = 'none';
            gettingStartedPopup.style.display = 'none';
        }
        
        // Close popups when clicking close button
        closeButtons.forEach(button => {
            button.addEventListener('click', function() {
                hideAllPopups();
                overlay.style.display = 'none';
            });
        });
        
        // Close popups when clicking overlay
        overlay.addEventListener('click', function() {
            hideAllPopups();
            overlay.style.display = 'none';
        });
        
        // Tab switching functionality
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs in the same container
                const container = this.closest('.popup');
                container.querySelectorAll('.tab').forEach(t => {
                    t.classList.remove('active');
                });
                container.querySelectorAll('.tab-content').forEach(c => {
                    c.classList.remove('active');
                });
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Show corresponding content
                const tabName = this.getAttribute('data-tab');
                container.querySelector(`#${tabName}`).classList.add('active');
            });
        });
    </script>
</body>
</html>
